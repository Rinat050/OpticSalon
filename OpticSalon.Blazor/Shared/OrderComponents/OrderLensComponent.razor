@using MudBlazor.Utilities
@using OpticSalon.Blazor.Data.Credentials
@using OpticSalon.Domain.FilterData
@using OpticSalon.Domain.Models

<MudContainer Class="d-flex align-center justify-center mud-width-full">
    <MudCard Class="p-4 m-2 w-100" Style="border-radius: 15px;"
             Outlined="false" Elevation="5">
        <MudList Clickable="true">
            <MudListSubheader>
                <MudStack Row AlignItems="AlignItems.Center">
                    <MudIcon Icon="@Icons.Material.Outlined.Lens" Size="Size.Large"
                             Color="MudBlazor.Color.Secondary"></MudIcon>
                    <MudText Typo="Typo.h5" Color="MudBlazor.Color.Secondary">
                        Выбор пакета линз
                    </MudText>
                </MudStack>
            </MudListSubheader>
            @foreach (var lens in Packages)
            {
                <MudListItem OnClick="@(() => SelectLens(lens))" Icon="@(GetListItemIcon(lens))"
                         IconColor="@(GetListItemIconColor(lens))">
                    <MudText Typo="Typo.h6" Color="MudBlazor.Color.Primary">@lens.Name</MudText>
                    <MudText Class="m-1" Typo="Typo.body1">@lens.Description</MudText>
                    <MudStack Row AlignItems="AlignItems.Center">
                        <MudText Typo="Typo.subtitle2" Style="font-weight: 600" Color="MudBlazor.Color.Secondary">Стоимость:</MudText>
                        <MudChip Size="Size.Medium" Variant="Variant.Outlined" Color="MudBlazor.Color.Primary">@lens.Cost руб.</MudChip>
                    </MudStack>
                </MudListItem>
            }
        </MudList>
        <MudStack Row AlignItems="AlignItems.Center">
            <MudSelect @bind-Value="OrderCredentials.LensTintingPercent" Label="Тонировка линз (%)" T="int" Variant="Variant.Outlined">
                @foreach (var value in LensTintingFilter.GetLensTintingRange())
                {
                    <MudSelectItem Value="@(value)"></MudSelectItem>
                }
            </MudSelect>
        </MudStack>
    </MudCard>
</MudContainer>

@code {
    [Parameter]
    public OrderCreateCredentials OrderCredentials{ get; set; } = new();
    [Parameter]
    public List<LensPackage> Packages { get; set; } = new();

    private bool _isLoading;

    private void SelectLens(LensPackage lens)
    {
        OrderCredentials.LensPackage = lens;
    }

    private string GetListItemIcon(LensPackage lens)
    {
        if (OrderCredentials.LensPackage == lens) return Icons.Material.Outlined.Check;

        return Icons.Material.Outlined.DragHandle;
    }

    private MudBlazor.Color GetListItemIconColor(LensPackage lens)
    {
        if (OrderCredentials.LensPackage == lens) return MudBlazor.Color.Success;

        return MudBlazor.Color.Default;
    }
}
